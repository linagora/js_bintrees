RBTreeByIndex=function(l){var h=function(g){g=h.m[g];if(g.mod)return g.mod.exports;var k=g.mod={exports:{}};g(k,k.exports);return k.exports};h.m={};h.m["./treebase"]=function(g,h){function e(){}function f(d){this._tree=d;this._ancestors=[];this._cursor=null}e.prototype.clear=function(){this._root=null;this.size=0};e.prototype.find=function(d){for(var a=this._root;null!==a;){var b=this._comparator(d,a.data);if(0===b)return a.data;a=a.get_child(0<b)}return null};e.prototype.findIter=function(d){for(var a=
this._root,b=this.iterator();null!==a;){var c=this._comparator(d,a.data);if(0===c)return b._cursor=a,b;b._ancestors.push(a);a=a.get_child(0<c)}return null};e.prototype.lowerBound=function(d){for(var a=this._root,b=this.iterator(),c=this._comparator;null!==a;){var e=c(d,a.data);if(0===e)return b._cursor=a,b;b._ancestors.push(a);a=a.get_child(0<e)}for(e=b._ancestors.length-1;0<=e;--e)if(a=b._ancestors[e],0>c(d,a.data))return b._cursor=a,b._ancestors.length=e,b;b._ancestors.length=0;return b};e.prototype.upperBound=
function(d){for(var a=this.lowerBound(d),b=this._comparator;0===b(a.data(),d);)a.next();return a};e.prototype.min=function(){var d=this._root;if(null===d)return null;for(;null!==d.left;)d=d.left;return d.data};e.prototype.max=function(){var d=this._root;if(null===d)return null;for(;null!==d.right;)d=d.right;return d.data};e.prototype.iterator=function(){return new f(this)};e.prototype.eachNode=function(d){for(var a=this.iterator(),b,c=0;null!==(b=a.next());)d(b,c),c++};e.prototype.each=function(d){this.eachNode(function(a,
b){d(a.data,b)})};e.prototype.mapNode=function(d){for(var a=this.iterator(),b,c=[],e=0;null!==(b=a.next());)c.push(d(b,e)),e++;return c};e.prototype.map=function(d){return this.mapNode(function(a,b){return d(a.data,b)})};f.prototype.data=function(){return null!==this._cursor?this._cursor.data:null};f.prototype.next=function(){if(null===this._cursor){var d=this._tree._root;null!==d&&this._minNode(d)}else if(null===this._cursor.right){do if(d=this._cursor,this._ancestors.length)this._cursor=this._ancestors.pop();
else{this._cursor=null;break}while(this._cursor.right===d)}else this._ancestors.push(this._cursor),this._minNode(this._cursor.right);return null!==this._cursor?this._cursor:null};f.prototype.prev=function(){if(null===this._cursor){var d=this._tree._root;null!==d&&this._maxNode(d)}else if(null===this._cursor.left){do if(d=this._cursor,this._ancestors.length)this._cursor=this._ancestors.pop();else{this._cursor=null;break}while(this._cursor.left===d)}else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left);
return null!==this._cursor?this._cursor:null};f.prototype._minNode=function(d){for(;null!==d.left;)this._ancestors.push(d),d=d.left;this._cursor=d};f.prototype._maxNode=function(d){for(;null!==d.right;)this._ancestors.push(d),d=d.right;this._cursor=d};g.exports=e};h.m.__main__=function(g,k){function e(a){this._root=null;this._nil=new f("nil");this._nil.red=!1;this._nil.weight=0}function f(a){this.data=a;this.parent=this.right=this.left=null;this.red=!0;this.weight=1}var d=h("./treebase");e.prototype=
new d;e.prototype.insert=function(a,b){var c=new f(b);return this.insert_node(a,c)?c:!1};e.prototype.insert_node=function(a,b){var c=this._root;if(!c)return this._root=b,this._root.red=!1,!0;for(;;)if(c.weight===a){c=c.max_tree(function(a){a.weight+=1});c.set_child("right",b);b.parent=c;break}else if(left=c.get_child("left"),right=c.get_child("right"),left||0!==a)if(left&&left.weight>=a)c.weight+=1,c=left;else if(right)a-=(left?left.weight:0)+1,c.weight+=1,c=right;else{c.weight+=1;c.set_child("right",
b);b.parent=c;break}else{c.weight+=1;c.set_child("left",b);b.parent=c;break}this.insert_correction(b);return!0};e.prototype.insert_between=function(a,b,c){c=new f(c);a&&!a.right?(a.right=c,c.parent=a,this.insert_correction(c)):b&&!b.left?(b.left=c,c.parent=b,this.insert_correction(c)):this.insert_node(0,c);c.traverse_up(function(a,b){b.weight=(b.left?b.left.weight:0)+(b.right?b.right.weight:0)+1});return c};e.prototype.rotate=function(a,b){var c;c=b.get_child(a,!0);b.set_child(a,c.get_child(a),!0);
c.get_child(a)&&(c.get_child(a).parent=b);(c.parent=b.parent)?b===b.parent.get_child(a)?b.parent.set_child(a,c):b.parent.set_child(a,c,!0):this._root=c;c.set_child(a,b);b.parent=c;b.weight=(b.left?b.left.weight:0)+(b.right?b.right.weight:0)+1;c.weight=(c.left?c.left.weight:0)+(c.right?c.right.weight:0)+1};e.prototype.insert_correction=function(a){function b(b){var d;(d=a.parent.parent.get_child(b,!0))&&d.red?(a.parent.red=!1,d.red=!1,a.parent.parent.red=!0,a=a.parent.parent):(a===a.parent.get_child(b,
!0)&&(a=a.parent,c.rotate(b,a)),a.parent.red=!1,a.parent.parent.red=!0,c.rotate("left"===b?"right":"left",a.parent.parent))}for(var c=this;a.parent&&a.parent.red;)a.parent===a.parent.parent.get_child("left")?b("left"):a.parent===a.parent.parent.get_child("right")&&b("right");this._root.red=!1};e.prototype.find=function(){var a=this.findNode.apply(this,arguments);return a?a.data:null};e.prototype.findNode=function(a,b){if(a>=this.get_size()||0>a)return null;var c=this._root;if(!c)return null;for(;0<
a||0===a&&c.left;)if(left=c.left,right=c.right,left&&left.weight>a)b&&b(c),c=left;else if(!left&&0===a||left&&left.weight===a)break;else if(right)b&&b(c),c=right,a-=(left?left.weight:0)+1;else throw Error("this should not happen");return c};e.prototype.remove=function(a){a=this.findNode(a,function(a){a.weight--});return this.remove_helper(a)};e.prototype.remove_helper=function(a){var b,c,d;b=a.left&&a.right?a.next(function(a){--a.weight}):a;c=b.left?b.left:b.right;d=b.parent;c&&(c.parent=b.parent);
b.parent?b===b.parent.left?b.parent.left=c:b.parent.right=c:this._root=c;b!==a&&(a.data=b.data,a.weight=(a.left?a.left.weight:0)+(a.right?a.right.weight:0)+1);b.red||this.remove_correction(c,d);return b};e.prototype.remove_node=function(a){a.traverse_up(function(a,c){c.weight--});return this.remove_helper(a)};e.prototype.remove_correction=function(a,b){for(var c=this,d,e=function(e){var f=b.get_child(e,!0);f&&f.red&&(f.red=!1,b.red=!0,c.rotate(e,b),f=b.get_child(e,!0));f.left&&f.left.red||f.right&&
f.right.red?(f.get_child(e,!0)&&f.get_child(e,!0).red||(f.get_child(e)&&(f.get_child(e).red=!1),f.red=!0,d="left"===e?"right":"left",c.rotate(d,f),f=b.get_child(e,!0)),f.red=b?b.red:!1,b.red=!1,f.get_child(e,!0)&&(f.get_child(e,!0).red=!1),c.rotate(e,b),a=c._root):(f.red=!0,a=b);b=a.parent};!(a===this._root||a&&a.red);)a===b.get_child("left")?tmp=e("left"):a===b.get_child("right")&&(tmp=e("right"));a&&(a.red=!1)};e.prototype.get_size=function(){return this._root?this._root.weight:0};f.prototype.get_child=
function(a,b){b&&(a="left"===a?"right":"left");return"left"===a?this.left:this.right};f.prototype.set_child=function(a,b,c){c&&(a="left"===a?"right":"left");"left"===a?this.left=b:this.right=b};f.prototype.max_tree=function(a){var b=this;for(a&&a(b);b.right;)b=b.right,a&&a(b);return b};f.prototype.min_tree=function(a){var b=this;for(a&&a(b);b.left;)b=b.left,a&&a(b);return b};f.prototype.next=function(a){var b,c;if(this.get_child("right"))return this.get_child("right").min_tree(a);a&&a(this);b=this;
for(c=this.parent;c&&b===c.get_child("right");)b=c,c=b.parent,a&&a(c);return c};f.prototype.prev=function(a){var b,c;if(this.get_child("left"))return this.get_child("left").max_tree(a);a&&a(this);b=this;for(c=this.parent;c&&b===c.get_child("left");)b=c,c=b.parent,a&&a(c);return c};f.prototype.traverse_up=function(a){for(var b=this.parent,c=this;b;)a(c,b),c=b,b=b.parent};f.prototype.depth=function(){var a=0;this.traverse_up(function(){a++});return a};f.prototype.position=function(){var a=this.left?
this.left.weight:0;this.traverse_up(function(b,c){c.right===b&&(c.left&&(a+=c.left.weight),a+=1)});return a};g.exports=e};return h("__main__")}(window);
